<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="User">

	
	<select id="getUser" parameterType="com.test.dvo.UserVO"
 						resultType="com.test.dvo.UserVO">
 		select * 
 		from userinfo 
 		where id=#{id} and pw=#{pw}
 	</select>
 	
 	<select id="getIdck" parameterType="string" resultType="com.test.dvo.UserVO">
 		select *
 		from userinfo
 		where id=#{id}
 	</select>
 	
 	<select id="getInsert" parameterType="com.test.dvo.UserVO">
 		insert into userinfo(id, pw, name, insdate, useyn)
		values(#{id},#{pw},#{name},SYSDATE,#{useyn})
 	</select>
	
	<select id = "getDuplChk" parameterType="string" resultType="int">
    	SELECT COUNT(*) FROM userinfo WHERE id = #{id}
	</select>
	
	<insert id="getdetail" parameterType="com.test.dvo.DetailVO">
		insert into userinfodetail(id, userinfodetailcd, relcd, addrcd, addrname, mobiletelno, hometelno, insuser, insdate, useyn, delivname)
		values(#{id}, 
				(select 'U'||substr('000000000'||to_char(max(to_number(replace(nvl(userinfodetailcd,'0'),'U',''))) + 1),-8,8) userinfodetailcd from USERINFODETAIL), 
				#{relcd}, 
				#{addrcd}, 
				#{addrname}, 
				#{mobiletelno}, 
				#{hometelno}, 
				'신규가입자', 
				sysdate, 
				#{useyn}, 
				#{delivname})
	</insert>
	
	<select id="getlist" parameterType="com.test.dvo.CodemngVO" resultType="com.test.dvo.CodemngVO">
		SELECT LEVEL, cdno, cdlvl, upcd, cdname, insuser, insdate, useyn
  			FROM codemng
		CONNECT BY PRIOR  cdno = upcd
	</select>
	
	<!-- <insert id="getdetail" parameterType="com.test.dvo.DetailVO">
		insert into userinfodetail(id, userinfodetailcd, relcd, addrcd, addrname, mobiletelno, hometelno, insuser, insdate, useyn, delivname)
		values(#{id}, 'U00000018', #{relcd}, #{addrcd}, #{addrname}, #{mobiletelno}, #{hometelno}, '신규가입자', sysdate, #{useyn}, #{delivname})
	</insert> -->
</mapper>